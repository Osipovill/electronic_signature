# Система электронной подписи

## Описание
Реализация инфраструктуры открытых ключей (PKI) с поддержкой:
- Корневого удостоверяющего центра (Root CA)
- Промежуточных удостоверяющих центров (Intermediate CA)
- Клиентских приложений с GUI

## Соответствие заданию
Реализованы все требуемые алгоритмы:

1. **Формирование ключей клиента (алгоритм I)**
   - Реализовано в `rsa_utils.py` функцией `generate_rsa_keys()`
   - Генерирует пару ключей (KA, KA') для каждого клиента
   - Закрытый ключ KA хранится только у клиента
   - Открытый ключ KA' доступен всем участникам через сертификат

2. **Формирование ЭЦП сообщения (алгоритм G)**
   - Реализовано в `rsa_utils.py` функцией `rsa_sign()`
   - Создает подпись s для сообщения m с помощью закрытого ключа KA
   - Используется при подписи сообщений и сертификатов

3. **Проверка ЭЦП сообщения (алгоритм V)**
   - Реализовано в `rsa_utils.py` функцией `rsa_verify()`
   - Проверяет подпись s сообщения m с помощью открытого ключа KA'
   - Возвращает 0 при успешной проверке, 1 при ошибке

### Процесс обмена между клиентами
Реализованы все этапы:

1. **Создание УЦ**:
   - Генерация ключевой пары УЦ
   - Создание самоподписанного сертификата
   - Настройка для подписи сертификатов клиентов

2. **Регистрация клиентов**:
   - Генерация ключевой пары клиента
   - Формирование и подпись сертификата УЦ
   - Безопасная передача закрытого ключа
   - Проверка корректности регистрации

3. **Обмен сообщениями**:
   - Получение сертификата получателя
   - Проверка цепочки сертификатов
   - Подпись и шифрование сообщений
   - Проверка подписи и расшифрование

## Компоненты системы
1. **Корневой УЦ** (`root_ca.py`):
   - Генерация корневой пары ключей RSA
   - Создание самоподписанного сертификата
   - Подпись сертификатов промежуточных УЦ

2. **Промежуточные УЦ** (`ca_node.py`):
   - Получение сертификата от корневого УЦ
   - Ведение базы данных клиентских сертификатов
   - Подпись клиентских сертификатов

3. **Клиентское приложение** (`client_gui.py`):
   - GUI на Tkinter
   - Генерация ключевой пары RSA
   - Получение сертификата от УЦ
   - Обмен подписанными сообщениями

## Установка
```bash
# Создание виртуального окружения
python -m venv venv
source venv/bin/activate  # для Linux/Mac
venv\Scripts\activate     # для Windows

# Установка зависимостей
pip install -r requirements.txt
```

## Запуск
1. Запуск корневого УЦ:
```bash
uvicorn root_ca:app --port 8000
```

2. Запуск промежуточных УЦ:
```bash
python ca_node.py --name "CA A" --port 8001 --root-url http://localhost:8000
python ca_node.py --name "CA B" --port 8002 --root-url http://localhost:8000
```

3. Запуск клиентских приложений:
```bash
python client_gui.py --id A1 --ca-url http://localhost:8001 --listen 9001
python client_gui.py --id B1 --ca-url http://localhost:8002 --listen 9002
```

## Структура проекта
- `root_ca.py` - Корневой удостоверяющий центр
- `ca_node.py` - Промежуточный удостоверяющий центр
- `client_gui.py` - Клиентское приложение с GUI
- `rsa_utils.py` - Утилиты для работы с RSA
- `settings.json` - Настройки портов и URL
- `requirements.txt` - Зависимости проекта

## Функциональность
- Генерация RSA ключей
- Создание и подпись сертификатов
- Проверка цепочки сертификатов
- Шифрование и подпись сообщений
- Графический интерфейс для клиентов

## Безопасность
- Полная проверка цепочки сертификатов
- Проверка цифровых подписей
- Безопасное хранение закрытых ключей
- Разделение ролей УЦ